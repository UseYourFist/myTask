<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="design/css/style.css">
    <title>My task</title>
    <script src="application/factory.js"></script>
    <script src="application/main.js"></script>
</head>
<body>
<canvas class="content" height='500' width='700' id='shape'></canvas>
<form>
    <div class="control">
    <header>
        <h3>Add Shape:</h3>
    </header>
    <div class="position element">
        <div class="txt-wrapper wrapper">
            <label for="left">Left:</label>
            <input type="number" autofocus placeholder="250" min="0" max="700" value="250" name="left" id="left" title="Вы можете указать положение элемента щёлкнув на холсте">
        </div>
        <div class="txt-wrapper wrapper">
            <label for="top">Top:</label>
            <input type="number" placeholder="100" min="0" max="500" value="100" name="top" id="top" title="Вы можете указать положение элемента щёлкнув на холсте">
        </div>
    </div>
    <div class="rectangle element">
        <div class="btn-wrapper wrapper">
            <input type="button" value="Rectangle" onclick="createRectangle()">
        </div>
        <div class="clr-wrapper wrapper">
            <input id="color" type="color" value="#fa8e47" name="color">
        </div>
        <div class="txt-wrapper wrapper">
            <label for="width">W:</label>
            <input type="number" placeholder="100" value="100" min="0" max="700" name="width" id="width">
        </div>
        <div class="txt-wrapper wrapper">
            <label for="height">H:</label>
            <input type="number" placeholder="100" value="100" min="0" max="500" name="height" id="height">
        </div>
    </div>
    <div class="circle element">
        <div class="btn-wrapper wrapper">
            <input type="button" value="Circle" onclick="createCircle()">
        </div>
        <div class="clr-wrapper wrapper">
            <input id="color1" type="color" value="#4dfa76" name="color1">
        </div>
        <div class="txt-wrapper wrapper">
            <label for="radius">R :</label>
            <input type="number" placeholder="60" value="60" min="0" max="250" name="radius" id="radius">
        </div>
    </div>
    <div class="triangle element">
        <div class="btn-wrapper wrapper">
            <input type="button" value="Triangle" onclick="createTriangle()">
        </div>
        <div class="clr-wrapper wrapper">
            <input id="color0" type="color" value="#657efa" name="color0">
        </div>
        <div class="txt-wrapper wrapper">
            <label for="width1">W:</label>
            <input type="number" placeholder="100" value="100" min="0" max="500" name="width1" id="width1">
        </div>
        <div class="txt-wrapper wrapper">
            <label for="height1">H:</label>
            <input type="number" placeholder="100" value="100" min="0" max="700" name="height1" id="height1">
        </div>
    </div>
    <div class="clean btn-wrapper">
        <input type="reset" name="rese" value="Clean options">
    </div>
    <div class="far-element btn-wrapper">
        <input type="button" value="Remove shape" onclick="removeShape()">
    </div>
    <div class="far-element-next btn-wrapper">
        <input type="button" value="Clean canvas" onclick="removeShapes()">
    </div>
    <div class="gravitation">
        <input id="gravitation" type="checkbox" onchange="grav(this)">
        <label for="gravitation">Enable gravitation</label>
    </div>
    <div class="borders">
         <input id="borders" type="checkbox" onchange="bord(this)">
         <label for="borders">Enable border for shapes</label>
    </div>
</div>
</form>
<script>
    var shape = this.__shape =  new fabric.Canvas('shape');
    shape.backgroundColor = 'white';
    shape.selection = false;
    shape.hoverCursor = 'pointer';

    shape.on('mouse:over', function(e) {
        e.target.setStroke('red');
        e.target.setOpacity(0.8);
        e.target.setStrokeDashArray ([5, 5]);
        shape.renderAll();
    });

    shape.on('mouse:out', function(e) {
        e.target.setStroke('grey');
        e.target.setOpacity(1);
        e.target.setStrokeDashArray ([5, 0]);
        shape.renderAll();
    });

    shape.on('mouse:down', function(options) {
        document.getElementById("left").value = options.e.clientX;
        document.getElementById("top").value = options.e.clientY
    });
    var a = 0;
    function bord(obj) {
        if (obj.checked) {
            a = 1;
            alert(a)
        }
        else {
            a = 0;
            alert(a)
        }
    }
    shape.on('mouse:move', function(options) {

                if (options.e.clientX > 700 - shape.getActiveObject().width && a == 1) {
                    shape.getActiveObject().lockMovementX = true;
                }
                else if (options.e.clientX < 0 + shape.getActiveObject().width && a == 1) {
                    shape.getActiveObject().lockMovementX = true;
                }
                else if (options.e.clientX > 0 + shape.getActiveObject().width && a == 1) {
                    shape.getActiveObject().lockMovementX = false;
                }
                if (options.e.clientY > 500 - shape.getActiveObject().height && a == 1) {
                    shape.getActiveObject().lockMovementY = true;
                }
                else if (options.e.clientY < 0 + shape.getActiveObject().height && a == 1) {
                    shape.getActiveObject().lockMovementY = true;
                }
                else if (options.e.clientY > 0 + shape.getActiveObject().height && a == 1) {
                    shape.getActiveObject().lockMovementY = false;
                }
                else if (a == 0) {
                    shape.getActiveObject().lockMovementY = false;
                    shape.getActiveObject().lockMovementX = false;

                }
            });
</script>
</body>
</html>